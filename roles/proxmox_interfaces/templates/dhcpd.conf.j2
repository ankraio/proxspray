# Managed by Ansible
option domain-name "ankra.dev";
option domain-name-servers 1.1.1.1, 8.8.8.8;

default-lease-time 600;
max-lease-time 7200;
authoritative;

# Subnet declarations from proxmox_interfaces
{% for iface in proxmox_interfaces %}
{% if iface.name == 'vmbr2' %}
# VM Network - DHCP enabled
subnet {{ iface.cidr.split('/')[0] | regex_replace('\.\d+$', '.0') }} netmask 255.255.255.0 {
  range {{ iface.cidr.split('/')[0] | regex_replace('\.1$', '.100') }} {{ iface.cidr.split('/')[0] | regex_replace('\.1$', '.200') }};
  option routers {{ iface.cidr.split('/')[0] }};
  option domain-name-servers 1.1.1.1, 8.8.8.8;
  option domain-name "ankra.local";
}
{% else %}
# {{ iface.description | default(iface.name) }} - No DHCP (static only)
subnet {{ iface.cidr.split('/')[0] | regex_replace('\.\d+$', '.0') }} netmask 255.255.255.0 {
  # Static IP subnet - no DHCP range
}
{% endif %}
{% endfor %}
